import{_ as e,c as o,o as t,R as i}from"./chunks/framework.70e71619.js";const f=JSON.parse('{"title":"Triggers","description":"A Trigger initiates a Flow on some internal or external event, such as an in-app activity, incoming webhook, cron job, execution of Operation(s) from other Flows, and beyond!","frontmatter":{"description":"A Trigger initiates a Flow on some internal or external event, such as an in-app activity, incoming webhook, cron job, execution of Operation(s) from other Flows, and beyond!","readTime":"3 min read"},"headers":[],"relativePath":"app/flows/triggers.md","lastUpdated":1682552691000}'),n={name:"app/flows/triggers.md"},a=i(`<h1 id="triggers" tabindex="-1">Triggers <a class="header-anchor" href="#triggers" aria-label="Permalink to &quot;Triggers&quot;">​</a></h1><blockquote><p>A trigger defines the event that starts your flow. This could be from an internal or external activity, such as changes to data, logins, errors, incoming webhooks, cron jobs, operations from other flows, or even the click of a button within the Data Studio.</p></blockquote><div class="tip custom-block"><p class="custom-block-title">Before You Begin</p><p>Please be sure to read the overview documentation on <a href="/configuration/flows.html">Flows</a>.</p></div><h2 id="event-hook" tabindex="-1">Event Hook <a class="header-anchor" href="#event-hook" aria-label="Permalink to &quot;Event Hook&quot;">​</a></h2><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers/triggers-20220603A/event-hook-20220602A.webp" alt="Event Hooks"></p><p>Event Hooks are triggered by events within the platform. The logic is based on <a href="/extensions/hooks.html">Custom API Hooks</a>. Any data generated by the event will be nested in the <code>$trigger</code>.</p><ul><li><strong>Type</strong> — Choose the type of event hook: <ul><li><a href="#filters">Filter (Blocking)</a> — This pauses the transaction and passes the <code>payload</code> to your flow, allowing you to validate or transform <code>payload</code> or even prevent the event transaction.</li><li><a href="#actions">Action (Non-Blocking)</a> — Actions do not block the event. A non-blocking action is mostly useful for completing tasks in response to an event, without modifying the event or slowing the API.</li></ul></li><li><strong>Scope</strong> — Set the types of events that trip this trigger.</li><li><strong>Collections</strong> — Set the collections <em>whose events</em> trip this trigger.</li><li><strong>Response Body</strong> — This is optional. Its also only for <strong>Filter (Blocking)</strong> events. Defines data to replace the event&#39;s original <code>payload</code>. Choose to return: <ul><li><strong>Data of Last Operation</strong> — Replaces event <code>payload</code> with value from <code>$last</code>.</li><li><strong>All Data</strong> — Replaces event <code>payload</code> with the entire data chain.</li><li><strong>Other</strong> — Replaces event <code>payload</code> with value from an <code>&lt;operationKey&gt;</code>.</li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">Events with Multiple Items</p><p>If you create items in a single request, the Flow will trigger once for each and every item. If you create three items, the flow runs three separate times. On each run, just one item will be in the payload.</p></div><h3 id="filters" tabindex="-1">Filters <a class="header-anchor" href="#filters" aria-label="Permalink to &quot;Filters&quot;">​</a></h3><p>A Filter will halt the event transaction, copy the event <code>payload</code> into the flow, let the whole flow run, <strong><em>optionally</em></strong> replace the original <code>payload</code> by configuring <strong>Response Body</strong>, then resume the event&#39;s transaction to the database.</p><p>For example, let&#39;s say you configure the scope to be <code>item.create</code>.</p><ul><li>A request to create an item is sent to Directus.</li><li>The create item event halts.</li><li>The event&#39;s <code>payload</code> is copied into the <code>$trigger</code> of the flow.</li><li>The flow runs.</li><li><em>Optional:</em> If you defined a <strong>Response Body</strong>, this replaces the event&#39;s <code>payload</code>.</li><li>The event transaction is committed or cancelled, based on your flow&#39;s logic.</li></ul><div class="tip custom-block"><p class="custom-block-title">Response Body</p><p>If no <strong>Response Body</strong> is configured, the original payload will not be modified, but you&#39;d still have the ability to cancel the transaction.</p></div><div class="tip custom-block"><p class="custom-block-title">Cancelling Transactions</p><p>To completely cancel a transaction, you&#39;ll need to throw an error within a <a href="/configuration/flows/operations.html#script">script operation</a> or end the flow on a <a href="/configuration/flows.html#control-flow">failure path</a>.</p></div><h3 id="actions" tabindex="-1">Actions <a class="header-anchor" href="#actions" aria-label="Permalink to &quot;Actions&quot;">​</a></h3><p>An Action lets the event commit its transaction to the database without waiting for the flow to finish. Therefore, Actions give you a more performant API, but you have no ability to validate or transform the payload before the transaction is committed to the database. However, a copy of the <code>payload</code> is still added into <code>$trigger</code> to use as desired.</p><p>For example, let&#39;s imagine once more that you configure the scope to be <code>item.create</code>.</p><ul><li>A request to create an item is sent to Directus.</li><li>The create item event is transacted.</li><li>The event&#39;s <code>payload</code> is copied into the <code>$trigger</code> of the flow.</li><li>The flow runs.</li></ul><p>To recap, Filters let you modify the original <code>payload</code> of an event but block the API until the flow finishes. Actions still provide the <code>payload</code> to the flow, but don&#39;t let you modify it before transaction; so you get a faster API but no control over the event transaction.</p><h2 id="webhook" tabindex="-1">Webhook <a class="header-anchor" href="#webhook" aria-label="Permalink to &quot;Webhook&quot;">​</a></h2><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers/triggers-20220603A/webhook-20220602A.webp" alt="Webhook"></p><p>Triggers on an incoming HTTP request to: <code>/flows/trigger/:this-webhook-trigger-id</code> which you can copy from the webhook trigger panel.</p><ul><li><strong>Method</strong> — Choose whether the flow will be triggered by a <code>GET</code> or <code>POST</code> request from the dropdown.</li><li><strong>Asynchronous</strong> — Toggle whether or not the trigger responds asynchronously.</li><li><strong>Response Body</strong> — Optional. Defines data to return as a response. Choose to return: <ul><li><strong>Data of Last Operation</strong> — Responds with value from <code>$last</code>.</li><li><strong>All Data</strong> — Responds with the entire data chain.</li><li><strong>Other</strong> — Responds with value from an <code>&lt;operationKey&gt;</code>.</li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">Response Body</p><p>If no data is defined in <strong>Response Body</strong>, the response is empty.</p></div><div class="tip custom-block"><p class="custom-block-title">Asynchronous</p><p>If <strong>Asynchronous</strong> is enabled, the flows system will immediately resolve/respond to the request without returning a <strong>Response Body</strong>, which frees up the API immediately. If it is disabled, the flows system will wait for the flow to finish and return whatever value is in <strong>Response Body</strong>. This slows the API, but lets you send data.</p></div><h2 id="schedule-cron" tabindex="-1">Schedule (CRON) <a class="header-anchor" href="#schedule-cron" aria-label="Permalink to &quot;Schedule (CRON)&quot;">​</a></h2><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers/triggers-20220603A/cron-20220602A.webp" alt="Schedule a Cron Job"></p><p>This trigger enables you to create data at scheduled intervals, via <a href="https://github.com/node-cron/node-cron#cron-syntax" target="_blank" rel="noreferrer">6-point cron job syntax</a>.</p><ul><li><strong>Interval</strong> — Set the cron job interval to schedule when the flow triggers.</li></ul><p><strong>Syntax Explanation</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">┌────────────── second (0-59)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ ┌──────────── minute (0-59)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ ┌────────── hour (0-23)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ │ ┌──────── day of month (1-31)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ │ │ ┌────── month (1-12)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ │ │ │ ┌──── day of week (0-7)</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ │ │ │ │</span></span>
<span class="line"><span style="color:#A6ACCD;"> │ │ │ │ │ │</span></span>
<span class="line"><span style="color:#A6ACCD;"> * * * * * *</span></span></code></pre></div><h2 id="another-flow" tabindex="-1">Another Flow <a class="header-anchor" href="#another-flow" aria-label="Permalink to &quot;Another Flow&quot;">​</a></h2><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers/triggers-20220603A/another-flow-20220602A.webp" alt="Another Flow"></p><p>This trigger executes by the <a href="/configuration/flows/operations.html#another-flow">trigger flow</a> operation, allowing you to chain flows.</p><ul><li><strong>Response Body</strong> — Optional. Defines data to return and append under the <code>&lt;operationKey&gt;</code> of <a href="/configuration/flows/operations.html#another-flow">trigger flow</a> operation that tripped the trigger. Choose to return: <ul><li><strong>Data of Last Operation</strong> — Responds with value from <code>$last</code>.</li><li><strong>All Data</strong> — Responds with the entire data chain.</li><li><strong>Other</strong> — Responds with value from an <code>&lt;operationKey&gt;</code>.</li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">Flows for-loops</p><p>If you pass an array to this trigger, it will run once for each item in the array.</p></div><h2 id="manual" tabindex="-1">Manual <a class="header-anchor" href="#manual" aria-label="Permalink to &quot;Manual&quot;">​</a></h2><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers-20230227A/manual-20230227A.webp" alt="A pane is open in front of a Flow. It shows various options detailed below."></p><p>This Trigger starts your flow on a manual click of a button within the Data Studio. When you use this trigger, a <strong>Flows</strong> menu containing a button will appear in the sidebar of the specified collection page(s) and/or its item pages.</p><p>The manual trigger must take in item ID(s) before you can click it. So on the collection page, the button will be <em>grayed out</em> until you select some number of items. From the item page, the current item&#39;s ID is passed in automatically. These item IDs are passed in to <code>$trigger</code>.</p><ul><li><strong>Collections</strong> — Choose the Collection(s) to add the button to.</li><li><strong>Location</strong> — Choose to display the button on the <a href="/app/content.html#item-page">Item Page</a>, <a href="/app/content.html#collection-page">Collection Page</a>, or both.</li><li><strong>Asynchronous</strong> — Toggle whether the Flow executes asynchronously. If enabled, you can immediately trigger the flow again. If not, you must wait for the flow to complete to use it again.</li><li><strong>Collection Page (Requires Selection)</strong> — Toggle whether a selection is required in the Collection Page to trigger.</li><li><strong>Require Confirmation</strong> - Toggle whether a confirmation dialog will be shown before the flow is executed.</li></ul><p>After the operation runs, a toast notification will appear in your <a href="/app/overview.html#4-sidebar">sidebar</a> indicating whether the flow ran successfully.</p><h3 id="confirmation-dialog" tabindex="-1">Confirmation Dialog <a class="header-anchor" href="#confirmation-dialog" aria-label="Permalink to &quot;Confirmation Dialog&quot;">​</a></h3><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers-20230227A/manual-confirmation-dialog-20230227A.webp" alt="A modal is shown reading &quot;Please provide alert information&quot; with two text fields - one for text and one for content."></p><p>If enabled, a confirmation dialog will be shown in a modal before the flow is executed. There are further options to set up a confirmation dialog.</p><ul><li><strong>Confirmation Description</strong> - Text shown at the top of the modal.</li><li><strong>Confirmation Input Fields</strong> - Set up one or more inputs to be filled by users before executing the flow.</li></ul><p><img src="https://cdn.directus.io/docs/v9/configuration/flows/triggers-20230227A/manual-input-settings-20230227A.webp" alt="A pane is open in front of a Flow. It shows various options detailed below."></p><p>Each input field can have its own data type, interface, and display options. Some convenience options are also provided to immediately alter the user input (such as trimming whitespace and slugifying text).</p><p>Data provided by users when triggering a manual flow with a confirmation dialog will be accessible in <code>$trigger.body</code> in the data chain.</p>`,49),s=[a];function r(l,c,h,d,p,g){return t(),o("div",null,s)}const m=e(n,[["render",r]]);export{f as __pageData,m as default};
