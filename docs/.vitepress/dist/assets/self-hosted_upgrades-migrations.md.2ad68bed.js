import{_ as e,c as a,o as t,R as o}from"./chunks/framework.70e71619.js";const m=JSON.parse('{"title":"Upgrades & Migrations","description":"A Project is a complete instance of Directus, including its **Database**, config file, asset storage, and any custom extensions.","frontmatter":{"description":"A Project is a complete instance of Directus, including its **Database**, config file, asset storage, and any custom extensions.","readTime":"4 min read"},"headers":[],"relativePath":"self-hosted/upgrades-migrations.md","lastUpdated":1682552691000}'),r={name:"self-hosted/upgrades-migrations.md"},i=o('<h1 id="upgrades-migrations" tabindex="-1">Upgrades &amp; Migrations <a class="header-anchor" href="#upgrades-migrations" aria-label="Permalink to &quot;Upgrades &amp; Migrations&quot;">​</a></h1><blockquote><p>A Project is a complete instance of Directus, including its <strong>Database</strong>, config file, asset storage, and any custom extensions. <a href="/getting-started/glossary.html#projects">Learn more about Projects</a>.</p></blockquote><h2 id="upgrading-updating-a-project" tabindex="-1">Upgrading / Updating a Project <a class="header-anchor" href="#upgrading-updating-a-project" aria-label="Permalink to &quot;Upgrading / Updating a Project&quot;">​</a></h2><ol><li>Backup your project</li><li>Run <code>npm update</code></li><li>Run <code>npx directus database migrate:latest</code> to update the DB</li></ol><h2 id="backing-up-a-project" tabindex="-1">Backing-up a Project <a class="header-anchor" href="#backing-up-a-project" aria-label="Permalink to &quot;Backing-up a Project&quot;">​</a></h2><ol><li>Make a copy of the <strong>files within each storage adapter</strong>, and store them in a safe place.</li><li>Make a copy of the <code>/api/.env</code> file, and store it in a safe place.</li><li>Create a database dump.</li></ol><h2 id="migrating-a-project" tabindex="-1">Migrating a Project <a class="header-anchor" href="#migrating-a-project" aria-label="Permalink to &quot;Migrating a Project&quot;">​</a></h2><p>Directus doesn&#39;t rely on anything besides the database for it&#39;s operation. Therefore, migrating your Directus project can be done by moving the whole database to a new location using a database dump.</p><div class="tip custom-block"><p class="custom-block-title">File Storage</p><p>If you have files uploaded, make sure to copy those over as well, or use the same storage location in the new location of Directus.</p></div><h2 id="downgrading-a-project" tabindex="-1">Downgrading a Project <a class="header-anchor" href="#downgrading-a-project" aria-label="Permalink to &quot;Downgrading a Project&quot;">​</a></h2><p>Directus can be reverted to an earlier version by going to your terminal, navigating into your project folder and running <code>npm install directus@&lt;version&gt;</code>.</p><p>If you ran any database migrations for a newer version, you can revert those by running <code>npx directus database migrate:down</code></p><h2 id="deleting-a-project" tabindex="-1">Deleting a Project <a class="header-anchor" href="#deleting-a-project" aria-label="Permalink to &quot;Deleting a Project&quot;">​</a></h2><ol><li>Optional: <strong>Backup any local files</strong> stored within the project&#39;s root directory</li><li>Optional: <strong>Backup any custom code and extensions</strong> within the project&#39;s root directory</li><li>Optional: <strong>Backup your entire database</strong>, only system tables, or only project tables</li><li><strong>Delete the project&#39;s root directory</strong> from the server</li><li><strong>Delete all Directus system tables</strong> (<code>directus_*</code>) from the database</li></ol><div class="tip custom-block"><p class="custom-block-title">Pure SQL</p><p>After completing this process, you will be left with a pure SQL database, with no trace that Directus was ever installed. Any external services connecting to your database&#39;s project tables directly (e.g., SQL queries) should continue working normally.</p></div><h2 id="migrating-from-version-8" tabindex="-1">Migrating from Version 8 <a class="header-anchor" href="#migrating-from-version-8" aria-label="Permalink to &quot;Migrating from Version 8&quot;">​</a></h2><p>There are two ways to migrate from an existing Directus 8.X instance:</p><ul><li><a href="#automated-script">Automated Script</a> (recommended)</li><li><a href="#manual-database-export-import">Manual Database Export/Import</a></li></ul><p>Be sure to check the <a href="#breaking-changes">Breaking changes</a> if you are consuming the API from an application.</p><h2 id="automated-script" tabindex="-1">Automated Script <a class="header-anchor" href="#automated-script" aria-label="Permalink to &quot;Automated Script&quot;">​</a></h2><p>We created a (community maintained) script, that will automatically copy over the schema, content, files, users, and roles from an existing v8 instance to a new v8 instance. This is the most hands-off approach to moving from a v8 to a version v9 instance, and is the recommended way of migrating your v8 instance.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The script, and instructions on how to run it, can be found on the<br><a href="https://github.com/directus-community/migration-tool" target="_blank" rel="noreferrer"><code>directus-community/migration-tool</code></a> repo.</p></div><p>This tool will copy over:</p><ul><li>Schema (collections / fields)</li><li>Files (including file contents)</li><li>User data (e.g., all items in all collections)</li><li>Roles</li><li>Users</li></ul><p>Due to significant differences in data structure between versions, this tool will <strong>NOT</strong> copy over:</p><ul><li>Interface/display configurations</li><li>Permissions</li><li>Activity / revisions</li></ul><h2 id="manual-database-export-import" tabindex="-1">Manual Database Export/Import <a class="header-anchor" href="#manual-database-export-import" aria-label="Permalink to &quot;Manual Database Export/Import&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">Automated</p><p>We highly recommend using the automated migration tool mentioned above. If that&#39;s not possible, you can perform the following steps to migrate your v8 instance.</p></div><p>Directus v9 is a breaking change coming from v8 (hence the major version bump), so you won&#39;t be able to just use your existing v8 database and run v9 on top of it. However, due to the database-mirroring approach of Directus, it&#39;s fairly straightforward to migrate your content from v8 to v9.</p><h4 id="_1-setup-a-fresh-v9-instance" tabindex="-1">1) Setup a Fresh v9 Instance <a class="header-anchor" href="#_1-setup-a-fresh-v9-instance" aria-label="Permalink to &quot;1) Setup a Fresh v9 Instance&quot;">​</a></h4><p>By installing Directus &quot;fresh&quot;, you&#39;re ensured your system tables are up-to-date and ready to go.</p><h4 id="_2-migrate-your-data" tabindex="-1">2) Migrate your Data <a class="header-anchor" href="#_2-migrate-your-data" aria-label="Permalink to &quot;2) Migrate your Data&quot;">​</a></h4><p>Using a tool like <a href="http://sequelpro.com" target="_blank" rel="noreferrer">Sequel Pro</a> or <a href="https://tableplus.com" target="_blank" rel="noreferrer">TablePlus</a>, export your v8 user-tables and import them into your v9 database.</p><p>Directus v9 will automatically recognize your tables, and you&#39;ll be ready to get started in v9.</p><p><strong>Note:</strong> If you have references to users and files, make sure to update them to the new UUID format.</p><h4 id="_3-configure-directus" tabindex="-1">3) Configure Directus <a class="header-anchor" href="#_3-configure-directus" aria-label="Permalink to &quot;3) Configure Directus&quot;">​</a></h4><p>Once the tables are in, you can start configuring the details of the schema. This includes choosing the correct interfaces, displays, and their options for your fields.</p><p>This would also be a good time to reconfigure your permissions, to ensure they are accurate.</p><h2 id="breaking-changes" tabindex="-1">Breaking changes <a class="header-anchor" href="#breaking-changes" aria-label="Permalink to &quot;Breaking changes&quot;">​</a></h2><ul><li><a href="/reference/filter-rules.html">Filter operators</a> have changed, now they are preceded with an underscore e.g.: <code>/items/users?filter[comments.thread.title][like]=Directus</code> is now <code>/items/users?filter[comments][thread][title][_like]=Directus</code></li></ul>',40),n=[i];function s(l,c,d,u,p,g){return t(),a("div",null,n)}const f=e(r,[["render",s]]);export{m as __pageData,f as default};
