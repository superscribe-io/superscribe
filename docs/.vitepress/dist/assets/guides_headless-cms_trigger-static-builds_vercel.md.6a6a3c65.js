import{_ as s,c as i,z as e,t,a,R as r,o as l}from"./chunks/framework.70e71619.js";const D=JSON.parse('{"title":"Triggering Static Site Builds with Vercel","description":"This recipe explains how to trigger a new build of your static website (hosted at Vercel) whenever a new article is published.","frontmatter":{"description":"This recipe explains how to trigger a new build of your static website (hosted at Vercel) whenever a new article is published.","tags":[],"skill_level":null,"directus_version":"9.21.2","author_override":null,"author":"Bryant Gillespie"},"headers":[],"relativePath":"guides/headless-cms/trigger-static-builds/vercel.md","lastUpdated":1682552691000}'),n={name:"guides/headless-cms/trigger-static-builds/vercel.md"},p=e("h1",{id:"triggering-static-site-builds-with-vercel",tabindex:"-1"},[a("Triggering Static Site Builds with Vercel "),e("a",{class:"header-anchor",href:"#triggering-static-site-builds-with-vercel","aria-label":'Permalink to "Triggering Static Site Builds with Vercel"'},"​")],-1),c={class:"tip custom-block"},d={class:"custom-block-title"},u=e("strong",null,"Directus Version:",-1),h=r(`<h2 id="explanation" tabindex="-1">Explanation <a class="header-anchor" href="#explanation" aria-label="Permalink to &quot;Explanation&quot;">​</a></h2><p>When using Directus as a Headless CMS, it is common to pair it with a front-end framework / static site generator like <a href="https://nextjs.org/" target="_blank" rel="noreferrer">Next.js</a>, <a href="https://nuxt.com" target="_blank" rel="noreferrer">Nuxt.js</a>, <a href="https://kit.svelte.dev/" target="_blank" rel="noreferrer">SvelteKit</a>, or other options.</p><p><a href="https://www.vercel.com/" target="_blank" rel="noreferrer">Vercel</a> and other similar platforms make it easy to host and deploy your site using static site generation (SSG) to render your site’s pages during build time, instead of waiting until a certain page is requested.</p><p>This recipe will show you how to trigger a new deployment or build for your site when new content is published or when existing content changes.</p><h2 id="how-to-guide" tabindex="-1">How-To Guide <a class="header-anchor" href="#how-to-guide" aria-label="Permalink to &quot;How-To Guide&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">Requirements</p><p>You’ll need to have already created a collection for your site content like <code>articles</code> or <code>posts</code> or <code>pages</code> with a field <code>status</code> that controls the published state. You&#39;ll also need to have a Vercel account and a site already hosted with them.</p></div><h3 id="create-and-configure-your-flow" tabindex="-1">Create and Configure Your Flow <a class="header-anchor" href="#create-and-configure-your-flow" aria-label="Permalink to &quot;Create and Configure Your Flow&quot;">​</a></h3><ol><li><p><a href="/configuration/flows.html#create-a-flow">Create a new Flow</a></p><p>Give it a memorable name and short description like <code>Trigger New Site Build</code>.</p></li><li><p><a href="/configuration/flows/triggers.html#triggers">Complete the Trigger Setup</a></p><p><img src="https://cdn.directus.io/docs/v9/headless-cms/how-to-packet-20220222A/static-site-build-trigger.webp" alt="The Trigger Setup tab of the Creating New Flow interface is show. The Event Hook type is selected. The Type field value is &quot;Action(Non-Blocking)&quot;. In the Scope field, &quot;items.create&quot; and &quot;items.update&quot; are selected."></p><p>a. Choose <strong>Event Hook</strong> for the trigger.</p><p>b. For <strong>Type</strong>, Select Action (Non-Blocking).</p><p>This will trigger this flow after the action (i.e. article updated) has already taken place.</p><p>c. For <strong>Scope</strong>, choose the following:</p><ul><li><code>items.create</code></li><li><code>items.update</code></li></ul><p>d. For <strong>Collections</strong>, choose any collections that should trigger this flow.</p><p>In this case, we’ll use <code>Articles</code> and <code>Articles Translations</code>.</p></li></ol><h3 id="add-an-operation-to-check-status-field" tabindex="-1">Add an Operation to Check Status Field <a class="header-anchor" href="#add-an-operation-to-check-status-field" aria-label="Permalink to &quot;Add an Operation to Check Status Field&quot;">​</a></h3><blockquote><p>This step is optional but it is recommended to add a Condition operation to prevent unnecessary builds.</p></blockquote><ol start="3"><li><p><a href="/configuration/flows/operations.html#operations">Create a new Operation</a></p><p><img src="https://cdn.directus.io/docs/v9/headless-cms/how-to-packet-20220222A/static-site-build-condition.webp" alt="Within a Directus Flow, the Create Operation screen is shown. The Name of the Operation is &quot;If Published&quot;. The Operation type is &quot;Condition&quot;. The value of the Condition Rules field is a JSON object."></p><p>a. Name your operation, i.e. <code>Check Status</code>, <code>If Published</code>, or similar.</p><p>b. Add your Condition Rules</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">$trigger</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">payload</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">			</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">status</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">				</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">_eq</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">published</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">			</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></li></ol><h3 id="configure-vercel-deploy-hook" tabindex="-1">Configure Vercel Deploy Hook <a class="header-anchor" href="#configure-vercel-deploy-hook" aria-label="Permalink to &quot;Configure Vercel Deploy Hook&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You can learn more about Vercel Deploy Hooks on their documentation.</p><p><a href="https://vercel.com/docs/concepts/git/deploy-hooks" target="_blank" rel="noreferrer">https://vercel.com/docs/concepts/git/deploy-hooks</a></p></div><ol start="4"><li><p>Copy your Deploy Hook URL from Vercel</p><p>a. Open your Vercel account</p><p>b. Navigate to your site → Settings → Git → Deploy Hooks</p><p>c. <strong>Create a new deploy hook and copy the unique URL.</strong></p></li></ol><h3 id="add-webhook-operation-to-your-flow" tabindex="-1">Add Webhook Operation to Your Flow <a class="header-anchor" href="#add-webhook-operation-to-your-flow" aria-label="Permalink to &quot;Add Webhook Operation to Your Flow&quot;">​</a></h3><ol start="5"><li><p>Back inside your Directus Flow, create a new Operation.</p><p><img src="https://cdn.directus.io/docs/v9/headless-cms/how-to-packet-20220222A/static-site-build-webhook.webp" alt="Within a Directus Flow, the Create Operation screen is shown. The Name of the Operation is &quot;Deploy Site&quot;. The Operation type is &quot;Webhook / Request URL&quot;. The Method selected is &quot;POST&quot;. The URL field value is the an HTTP address for the build hook from the hosting platform."></p><p>a. For the type of Operation, select <strong>Webhook / Request URL</strong></p><p>b. Change <strong>Method</strong> to POST</p><p>c. Paste the Build Hook URL from Vercel into the <strong>URL</strong> field</p><p>d. Save this Operation</p><p>e. Save your Flow</p></li></ol><h3 id="publish-your-flow" tabindex="-1">Publish Your Flow <a class="header-anchor" href="#publish-your-flow" aria-label="Permalink to &quot;Publish Your Flow&quot;">​</a></h3><p>Great job! Now whenever you update an item in the <code>articles</code> collection and the <code>status</code> is equal to <code>published</code> , your hosting platform will automatically re-build your site.</p><h2 id="final-tips" tabindex="-1">Final Tips <a class="header-anchor" href="#final-tips" aria-label="Permalink to &quot;Final Tips&quot;">​</a></h2><p>This recipe covers a basic example of triggering a static site build.</p><p>It can be used in addition to other Flows recipes to build a robust content approval and publishing workflow for your sites and projects.</p><p><strong>Tips</strong></p><ul><li>Make sure to test your flow several times to ensure everything is working as expected.</li><li>As you add other collections that are published on your static site or frontend, make sure you update this Flow to include those collections in your Trigger.</li></ul>`,23);function g(o,y,f,b,w,m){return l(),i("div",null,[p,e("blockquote",null,[e("p",null,t(o.$frontmatter.description),1)]),e("div",c,[e("p",d,"Author: "+t(o.$frontmatter.author),1),e("p",null,[u,a(" "+t(o.$frontmatter.directus_version),1)])]),h])}const F=s(n,[["render",g]]);export{D as __pageData,F as default};
